
{
    "_id": ObjectId("5a2f38458bcodgerce87vds"),
    "customerId": "45632",
    "cart": {
        "cartId": "e235",
        "items": [
            {
                "itemId": "Ä1234",
                "count": 3,
                "unitprice": 800
            },
            {
                "itemId": null,
                "count": 3,
                "unitprice": 800
            }
        ]
    }
},
{
    "_id": ObjectId("5a2f384345psdflver87vds"),
    "customerId": "584932",
    "cart": {
        "cartId": "e237",
        "items": [
            {
            "itemId": "Ä345",
            "count": 8,
            "unitprice": 457
            },
            {
                "itemId": null,
                "count": 3,
                "unitprice": 789.6
            }
        ]
    }
}

## (1) Find a customer with itemId is null
db.getCollection('Transaction')
  .find({'cart.items': {$elemMatch:{'itemId': null}}});

## (2) Get the null itemId list
db.getCollection('Transaction')
  .find({'cart.items': {$elemMatch:{'itemId': null}}})
  .forEach(function (document) {
    var items = cart.items;
    var len = items.length;
    for (var i = 0; i < len; i++) {
      if (items[i].itemId == null) {
        print(items[i])
      }
    }
  });

## (3) Delete only the items where itemID is null
db.getCollection('Transaction')
  .find({'cart.items': {$elemMatch:{'itemId': null}}})
  .forEach(function (document) {
    var items = document.cart.items;
    var len = items.length;
    var indexArray = [];
    for (var i = 0; i < len; i++) {
      if (items[i].itemId == null) {
        indexArray.push(i)
        print('Deleted Records adding index to index array: ',document.customerId,',', i)
      }
    }
    indexArray.forEach( function(index) {
        print('Deleted Records according to index array: ',document.customerId,',', index)
        items.pop(index);
    })
    db.Transaction.save(document); 
  });